def prepare_radar_data(df, cluster_col, group_features):
    df_clean = df[[cluster_col] + group_features].copy()
    df_clean[group_features] = df_clean[group_features].fillna(0)  # Fill missing values

    # Group by cluster and calculate mean
    cluster_means = df_clean.groupby(cluster_col)[group_features].mean()

    # Normalize across each feature (0-1)
    min_vals = cluster_means.min()
    max_vals = cluster_means.max()
    range_vals = max_vals - min_vals
    range_vals[range_vals == 0] = 1e-9  # avoid division by zero

    cluster_means_norm = (cluster_means - min_vals) / range_vals

    return cluster_means_norm
